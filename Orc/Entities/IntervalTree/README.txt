Code from https://github.com/vvondra/Interval-Tree